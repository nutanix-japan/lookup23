from flask import Flask, render_template
from google.oauth2 import service_account
from googleapiclient.discovery import build

# Replace with the ID of your Google Sheet
SPREADSHEET_ID = '1meMee6yCvtplZCkljknSYtdFECBEPauw8kn-1YB5x7A'

# Replace with the range of cells you want to read
RANGE_NAME = 'Sheet1!A1:L10'

# Replace with the path to your service account credentials JSON file
CREDENTIALS_FILE = 'credentials.json'

# Create credentials object for service account
creds = service_account.Credentials.from_service_account_file(CREDENTIALS_FILE)

# Build the Sheets API client
service = build('sheets', 'v4', credentials=creds)

# Create a Flask application
app = Flask(__name__)

# Define a route to display the data in a web form
@app.route('/')
def display_data():
    # Call the Sheets API to get data
    result = service.spreadsheets().values().get(
        spreadsheetId=SPREADSHEET_ID,
        range=RANGE_NAME
    ).execute()

    data = result.get('values', [])

    # Render the data in a web form using a template
    return render_template('data.html', data=data)

if __name__ == '__main__':
    app.run(debug=True)